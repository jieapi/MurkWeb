import{_ as me}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{r as m,a as S,l as _e,c as ve,o as M,d as l,e as t,w as s,b as n,S as fe,f as r,s as ge,i as be,t as u,n as ye,E as z,T as Ce}from"./index-BEccWB-n.js";const we={class:"api-management"},Ve={class:"card-header"},he={class:"price-text"},xe={class:"action-buttons"},Se={class:"pagination-container"},ze={class:"dialog-footer"},Ae={class:"stats-overview"},ke={class:"stats-item"},Pe={class:"stats-value"},De={class:"stats-item"},Te={class:"stats-value success"},Ue={class:"stats-item"},Re={class:"stats-value error"},$e={class:"stats-item"},Be={class:"stats-value warning"},Fe={class:"card-header"},Ie={class:"cost-text"},Ne={class:"user-type-item"},je={class:"user-type-info"},Ee={class:"user-type-count"},Le={class:"user-type-item"},Oe={class:"user-type-info"},qe={class:"user-type-count"},Me={class:"user-type-item"},He={class:"user-type-info"},Je={class:"user-type-count"},Ge={__name:"Scripts",setup(Ke){const A=m(!1),D=m(!1),V=m(!1),T=m("添加脚本"),U=m(!1),k=m(0),h=m(),R=S({id:null,name:"",version:"",price:0,status:"enabled",description:""}),C=S({name:"",status:""}),_=S({currentPage:1,pageSize:20}),i=S({id:null,name:"",version:"1.0.0",price:10,status:"enabled",description:""}),H={name:[{required:!0,message:"请输入脚本名称",trigger:"blur"},{min:2,max:50,message:"长度在 2 到 50 个字符",trigger:"blur"}],version:[{required:!0,message:"请输入版本号",trigger:"blur"}],price:[{required:!0,message:"请输入价格",trigger:"blur"},{type:"number",min:0,message:"价格必须大于等于0",trigger:"blur"}]},b=m([]),F=[{id:1,name:"murkphp加密脚本-基础版",version:"1.0.0",price:10,callCount:1256,status:"enabled",createdAt:"2024-01-01 09:00:00",updatedAt:"2024-01-15 10:30:25",description:"PHP代码基础加密脚本"},{id:2,name:"murkphp加密脚本-高级版",version:"2.0.0",price:20,callCount:856,status:"enabled",createdAt:"2024-01-01 09:00:00",updatedAt:"2024-01-15 10:30:25",description:"PHP代码高级加密脚本，更强的混淆和保护"},{id:3,name:"JS加密脚本",version:"1.5.0",price:15,callCount:532,status:"enabled",createdAt:"2024-01-05 14:20:00",updatedAt:"2024-01-15 10:30:25",description:"JavaScript代码加密脚本"},{id:4,name:"文件加密脚本",version:"1.0.0",price:25,callCount:128,status:"disabled",createdAt:"2024-01-10 11:20:15",updatedAt:"2024-01-15 10:30:25",description:"通用文件加密脚本"}],c=S({successCount:1180,failCount:76,totalRevenue:12560.5,userTypes:{normal:720,normalPercent:57,agent:380,agentPercent:30,admin:156,adminPercent:13}}),J=m([{id:1001,username:"user001",time:"2024-01-15 10:30:25",status:"success",ip:"192.168.1.100",duration:235,cost:10},{id:1002,username:"agent001",time:"2024-01-15 10:25:15",status:"success",ip:"192.168.1.101",duration:189,cost:10},{id:1003,username:"user002",time:"2024-01-15 10:20:05",status:"failed",ip:"192.168.1.102",duration:312,cost:0},{id:1004,username:"admin",time:"2024-01-15 10:15:30",status:"success",ip:"192.168.1.100",duration:245,cost:10},{id:1005,username:"user003",time:"2024-01-15 10:10:20",status:"success",ip:"192.168.1.103",duration:198,cost:10}]),w=()=>{A.value=!0,setTimeout(()=>{b.value=F,k.value=F.length,A.value=!1},500)},G=()=>{_.currentPage=1,w()},K=()=>{Object.assign(C,{name:"",status:""}),_.currentPage=1,w()},Q=()=>{w()},W=()=>{T.value="添加脚本",I(),V.value=!0},X=o=>{T.value="编辑脚本",Object.assign(i,o),V.value=!0},Y=o=>{Object.assign(R,o),U.value=!0},Z=async o=>{try{await Ce.confirm(`确定要删除脚本 "${o.name}" 吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const e=b.value.findIndex(v=>v.id===o.id);e>-1&&(b.value.splice(e,1),k.value--,z.success("删除成功"))}catch{}},ee=o=>{const e=o.status==="enabled"?"启用":"禁用";z.success(`脚本 "${o.name}" 已${e}`)},te=async()=>{h.value&&await h.value.validate(o=>{o&&(D.value=!0,setTimeout(()=>{if(D.value=!1,i.id){const e=b.value.findIndex(v=>v.id===i.id);e>-1&&(b.value[e]={...i,updatedAt:new Date().toLocaleString("zh-CN")},z.success("编辑成功"))}else{const e={...i,id:Date.now(),callCount:0,createdAt:new Date().toLocaleString("zh-CN"),updatedAt:new Date().toLocaleString("zh-CN")};b.value.unshift(e),k.value++,z.success("添加成功")}$()},1e3))})},$=()=>{V.value=!1,I()},I=()=>{Object.assign(i,{id:null,name:"",version:"1.0.0",price:10,status:"enabled",description:""}),h.value&&h.value.resetFields()},se=()=>{z.info("跳转到完整的调用记录页面")},le=o=>o<200?"duration-fast":o<300?"duration-normal":"duration-slow",ae=o=>{_.pageSize=o,w()},ne=o=>{_.currentPage=o,w()};return _e(()=>{w()}),(o,e)=>{const v=n("el-input"),f=n("el-form-item"),B=n("el-option"),oe=n("el-select"),ie=n("Search"),P=n("el-icon"),p=n("el-button"),N=n("Refresh"),de=n("Plus"),j=n("el-form"),g=n("el-card"),d=n("el-table-column"),E=n("el-switch"),L=n("el-table"),ue=n("el-pagination"),re=n("el-input-number"),O=n("el-dialog"),y=n("el-col"),q=n("el-row"),pe=n("el-tag"),ce=fe("loading");return M(),ve("div",we,[e[34]||(e[34]=l("h1",{class:"page-title"},"脚本管理",-1)),t(g,{class:"search-card"},{default:s(()=>[t(j,{model:C,inline:""},{default:s(()=>[t(f,{label:"脚本名称"},{default:s(()=>[t(v,{modelValue:C.name,"onUpdate:modelValue":e[0]||(e[0]=a=>C.name=a),placeholder:"请输入脚本名称",style:{width:"200px"},clearable:""},null,8,["modelValue"])]),_:1}),t(f,{label:"状态"},{default:s(()=>[t(oe,{modelValue:C.status,"onUpdate:modelValue":e[1]||(e[1]=a=>C.status=a),placeholder:"全部状态",clearable:"",style:{width:"120px"}},{default:s(()=>[t(B,{label:"全部状态",value:""}),t(B,{label:"启用",value:"enabled"}),t(B,{label:"禁用",value:"disabled"})]),_:1},8,["modelValue"])]),_:1}),t(f,null,{default:s(()=>[t(p,{type:"primary",onClick:G,loading:A.value},{default:s(()=>[t(P,null,{default:s(()=>[t(ie)]),_:1}),e[11]||(e[11]=r(" 搜索 ",-1))]),_:1,__:[11]},8,["loading"]),t(p,{onClick:K},{default:s(()=>[t(P,null,{default:s(()=>[t(N)]),_:1}),e[12]||(e[12]=r(" 重置 ",-1))]),_:1,__:[12]}),t(p,{type:"success",onClick:W},{default:s(()=>[t(P,null,{default:s(()=>[t(de)]),_:1}),e[13]||(e[13]=r(" 添加脚本 ",-1))]),_:1,__:[13]})]),_:1})]),_:1},8,["model"])]),_:1}),t(g,null,{header:s(()=>[l("div",Ve,[e[15]||(e[15]=l("span",null,"脚本列表",-1)),l("div",null,[t(p,{type:"primary",size:"small",onClick:Q},{default:s(()=>[t(P,null,{default:s(()=>[t(N)]),_:1}),e[14]||(e[14]=r(" 刷新 ",-1))]),_:1,__:[14]})])])]),default:s(()=>[ge((M(),be(L,{data:b.value,stripe:"",style:{width:"100%"},"table-layout":"fixed"},{default:s(()=>[t(d,{prop:"id",label:"ID",width:"80",align:"center"}),t(d,{prop:"name",label:"脚本名称",width:"200","show-overflow-tooltip":""}),t(d,{prop:"version",label:"版本",width:"100",align:"center"}),t(d,{prop:"price",label:"价格",width:"120",align:"center"},{default:s(({row:a})=>[l("span",he,"¥"+u(a.price)+"/次",1)]),_:1}),t(d,{prop:"callCount",label:"调用次数",width:"120",align:"center"}),t(d,{prop:"status",label:"状态",width:"100",align:"center"},{default:s(({row:a})=>[t(E,{modelValue:a.status,"onUpdate:modelValue":x=>a.status=x,"active-value":"enabled","inactive-value":"disabled",onChange:x=>ee(a)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),t(d,{prop:"createdAt",label:"创建时间",width:"160",align:"center"}),t(d,{prop:"updatedAt",label:"更新时间",width:"160",align:"center"}),t(d,{label:"操作",width:"200",fixed:"right",align:"center"},{default:s(({row:a})=>[l("div",xe,[t(p,{type:"text",size:"small",onClick:x=>X(a)},{default:s(()=>e[16]||(e[16]=[r(" 编辑 ",-1)])),_:2,__:[16]},1032,["onClick"]),t(p,{type:"text",size:"small",onClick:x=>Y(a),style:{color:"#67c23a"}},{default:s(()=>e[17]||(e[17]=[r(" 统计 ",-1)])),_:2,__:[17]},1032,["onClick"]),t(p,{type:"text",size:"small",onClick:x=>Z(a),style:{color:"#f56c6c"}},{default:s(()=>e[18]||(e[18]=[r(" 删除 ",-1)])),_:2,__:[18]},1032,["onClick"])])]),_:1})]),_:1},8,["data"])),[[ce,A.value]]),l("div",Se,[t(ue,{"current-page":_.currentPage,"onUpdate:currentPage":e[2]||(e[2]=a=>_.currentPage=a),"page-size":_.pageSize,"onUpdate:pageSize":e[3]||(e[3]=a=>_.pageSize=a),"page-sizes":[10,20,50,100],total:k.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:ae,onCurrentChange:ne},null,8,["current-page","page-size","total"])])]),_:1}),t(O,{modelValue:V.value,"onUpdate:modelValue":e[9]||(e[9]=a=>V.value=a),title:T.value,width:"600px","before-close":$},{footer:s(()=>[l("span",ze,[t(p,{onClick:$},{default:s(()=>e[19]||(e[19]=[r("取消",-1)])),_:1,__:[19]}),t(p,{type:"primary",onClick:te,loading:D.value},{default:s(()=>e[20]||(e[20]=[r(" 确定 ",-1)])),_:1,__:[20]},8,["loading"])])]),default:s(()=>[t(j,{ref_key:"apiFormRef",ref:h,model:i,rules:H,"label-width":"100px"},{default:s(()=>[t(f,{label:"脚本名称",prop:"name"},{default:s(()=>[t(v,{modelValue:i.name,"onUpdate:modelValue":e[4]||(e[4]=a=>i.name=a),placeholder:"请输入脚本名称"},null,8,["modelValue"])]),_:1}),t(f,{label:"版本",prop:"version"},{default:s(()=>[t(v,{modelValue:i.version,"onUpdate:modelValue":e[5]||(e[5]=a=>i.version=a),placeholder:"请输入版本号"},null,8,["modelValue"])]),_:1}),t(f,{label:"价格",prop:"price"},{default:s(()=>[t(re,{modelValue:i.price,"onUpdate:modelValue":e[6]||(e[6]=a=>i.price=a),min:0,precision:2,step:10,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),t(f,{label:"状态",prop:"status"},{default:s(()=>[t(E,{modelValue:i.status,"onUpdate:modelValue":e[7]||(e[7]=a=>i.status=a),"active-value":"enabled","inactive-value":"disabled","active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"])]),_:1}),t(f,{label:"脚本描述"},{default:s(()=>[t(v,{modelValue:i.description,"onUpdate:modelValue":e[8]||(e[8]=a=>i.description=a),type:"textarea",rows:3,placeholder:"请输入脚本描述"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),t(O,{modelValue:U.value,"onUpdate:modelValue":e[10]||(e[10]=a=>U.value=a),title:`脚本统计 - ${R.name}`,width:"900px"},{default:s(()=>[l("div",Ae,[t(q,{gutter:20},{default:s(()=>[t(y,{span:6},{default:s(()=>[t(g,{class:"stats-card"},{default:s(()=>[l("div",ke,[l("div",Pe,u(R.callCount||0),1),e[21]||(e[21]=l("div",{class:"stats-label"},"总调用次数",-1))])]),_:1})]),_:1}),t(y,{span:6},{default:s(()=>[t(g,{class:"stats-card"},{default:s(()=>[l("div",De,[l("div",Te,u(c.successCount),1),e[22]||(e[22]=l("div",{class:"stats-label"},"成功次数",-1))])]),_:1})]),_:1}),t(y,{span:6},{default:s(()=>[t(g,{class:"stats-card"},{default:s(()=>[l("div",Ue,[l("div",Re,u(c.failCount),1),e[23]||(e[23]=l("div",{class:"stats-label"},"失败次数",-1))])]),_:1})]),_:1}),t(y,{span:6},{default:s(()=>[t(g,{class:"stats-card"},{default:s(()=>[l("div",$e,[l("div",Be,"¥"+u(c.totalRevenue),1),e[24]||(e[24]=l("div",{class:"stats-label"},"总收入",-1))])]),_:1})]),_:1})]),_:1})]),t(g,{class:"recent-calls-card"},{header:s(()=>[l("div",Fe,[e[26]||(e[26]=l("span",null,"最近调用记录",-1)),t(p,{type:"text",onClick:se},{default:s(()=>e[25]||(e[25]=[r("查看全部",-1)])),_:1,__:[25]})])]),default:s(()=>[t(L,{data:J.value,style:{width:"100%"},size:"small"},{default:s(()=>[t(d,{prop:"id",label:"ID",width:"80",align:"center"}),t(d,{prop:"username",label:"用户名",width:"120"}),t(d,{prop:"time",label:"调用时间",width:"160",align:"center"}),t(d,{prop:"status",label:"状态",width:"100",align:"center"},{default:s(({row:a})=>[t(pe,{type:a.status==="success"?"success":"danger",size:"small"},{default:s(()=>[r(u(a.status==="success"?"成功":"失败"),1)]),_:2},1032,["type"])]),_:1}),t(d,{prop:"ip",label:"IP地址",width:"140",align:"center"}),t(d,{prop:"duration",label:"耗时",width:"100",align:"center"},{default:s(({row:a})=>[l("span",{class:ye(le(a.duration))},u(a.duration)+"ms",3)]),_:1}),t(d,{prop:"cost",label:"费用",width:"100",align:"center"},{default:s(({row:a})=>[l("span",Ie,"¥"+u(a.cost),1)]),_:1})]),_:1},8,["data"])]),_:1}),t(g,{class:"user-stats-card"},{header:s(()=>e[27]||(e[27]=[l("span",null,"用户类型分布",-1)])),default:s(()=>[t(q,{gutter:20},{default:s(()=>[t(y,{span:8},{default:s(()=>[l("div",Ne,[e[29]||(e[29]=l("div",{class:"user-type-icon normal-user"},null,-1)),l("div",je,[e[28]||(e[28]=l("div",{class:"user-type-name"},"普通用户",-1)),l("div",Ee,u(c.userTypes.normal)+"次 ("+u(c.userTypes.normalPercent)+"%)",1)])])]),_:1}),t(y,{span:8},{default:s(()=>[l("div",Le,[e[31]||(e[31]=l("div",{class:"user-type-icon agent-user"},null,-1)),l("div",Oe,[e[30]||(e[30]=l("div",{class:"user-type-name"},"代理商",-1)),l("div",qe,u(c.userTypes.agent)+"次 ("+u(c.userTypes.agentPercent)+"%)",1)])])]),_:1}),t(y,{span:8},{default:s(()=>[l("div",Me,[e[33]||(e[33]=l("div",{class:"user-type-icon admin-user"},null,-1)),l("div",He,[e[32]||(e[32]=l("div",{class:"user-type-name"},"管理员",-1)),l("div",Je,u(c.userTypes.admin)+"次 ("+u(c.userTypes.adminPercent)+"%)",1)])])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","title"])])}}},Xe=me(Ge,[["__scopeId","data-v-7b340cba"]]);export{Xe as default};
