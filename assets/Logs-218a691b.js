import{_ as ce}from"./_plugin-vue_export-helper-c27b6911.js";import{r as z,a as w,l as ue,b as n,R as de,o as r,c as p,d as g,e,w as t,f as c,t as i,v as pe,i as v,n as j,q as x,E as C}from"./index-8c5ed3cb.js";const me={class:"encrypt-logs"},_e={class:"button-group"},ge={class:"card-header"},fe={class:"table-container"},ye={class:"cost-text"},be={key:0,class:"cost-text actual-cost"},he={key:1,class:"text-muted"},Ce={key:1,class:"text-muted"},Se=["onClick"],ve={key:0},ke={key:1,class:"text-muted"},Te={class:"pagination-container"},ze={key:1},xe={class:"cost-text"},Re={key:0,class:"cost-text actual-cost"},Ve={key:1},Ne={__name:"Logs",setup(we){const k=z(!1),R=z(!1),V=z(0),o=w({id:null,username:"",scriptName:"",ip:"",encryptStatus:"",duration:0,submitTime:"",completeTime:"",estimatedCost:0,actualCost:0,fileSize:"",algorithm:"",userAgent:"",encryptContent:"",encryptResult:"",errorMessage:""}),m=w({scriptName:"",ip:"",encryptStatus:"",dateRange:[]}),f=w({currentPage:1,pageSize:20}),P=z([]),M=[{id:1001,username:"admin",scriptName:"PHP加密脚本",ip:"192.168.1.100",encryptStatus:"success",duration:235,submitTime:"2024-01-15 10:30:25",completeTime:"2024-01-15 10:30:26",estimatedCost:.5,actualCost:.45,fileSize:"2.3KB",algorithm:"标准加密 V1",userAgent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36",encryptContent:'<?php echo "Hello World"; ?>',encryptResult:"base64_encoded_encrypted_content_here...",errorMessage:""},{id:1002,username:"user001",scriptName:"JS混淆脚本",ip:"192.168.1.101",encryptStatus:"success",duration:189,submitTime:"2024-01-15 10:25:15",completeTime:"2024-01-15 10:25:16",estimatedCost:.3,actualCost:.28,fileSize:"1.8KB",algorithm:"超级加密 V3",userAgent:"PostmanRuntime/7.32.3",encryptContent:"function test() { return true; }",encryptResult:"obfuscated_js_code_here...",errorMessage:""},{id:1003,username:"agent001",scriptName:"PHP加密脚本",ip:"192.168.1.102",encryptStatus:"failed",duration:312,submitTime:"2024-01-15 10:20:05",completeTime:"2024-01-15 10:20:06",estimatedCost:.4,actualCost:0,fileSize:"0KB",algorithm:"标准加密 V1",userAgent:"curl/7.68.0",encryptContent:"",encryptResult:"",errorMessage:"加密失败：代码内容不能为空"},{id:1004,username:"user002",scriptName:"文件加密脚本",ip:"192.168.1.103",encryptStatus:"processing",duration:0,submitTime:"2024-01-15 10:15:30",completeTime:"",estimatedCost:1.2,actualCost:0,fileSize:"5.6MB",algorithm:"文件加密",userAgent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36",encryptContent:"large_file_content...",encryptResult:"",errorMessage:""},{id:1005,username:"user003",scriptName:"JS混淆脚本",ip:"192.168.1.104",encryptStatus:"queued",duration:0,submitTime:"2024-01-15 10:10:20",completeTime:"",estimatedCost:.35,actualCost:0,fileSize:"2.1KB",algorithm:"超级加密 V3",userAgent:"Python-requests/2.28.1",encryptContent:'console.log("test");',encryptResult:"",errorMessage:""},{id:1006,username:"user001",scriptName:"PHP加密脚本",ip:"192.168.1.101",encryptStatus:"failed",duration:1250,submitTime:"2024-01-15 10:05:10",completeTime:"2024-01-15 10:05:12",estimatedCost:.8,actualCost:0,fileSize:"4.2KB",algorithm:"超级加密 V3",userAgent:"PostmanRuntime/7.32.3",encryptContent:"very long php code content...",encryptResult:"",errorMessage:"加密失败：服务器内部错误，内存不足"},{id:1007,username:"hacker",scriptName:"PHP加密脚本",ip:"192.168.1.105",encryptStatus:"failed",duration:89,submitTime:"2024-01-15 10:00:05",completeTime:"2024-01-15 10:00:06",estimatedCost:.25,actualCost:0,fileSize:"1.1KB",algorithm:"标准加密 V1",userAgent:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7)",encryptContent:"<?php system($_GET['cmd']); ?>",encryptResult:"",errorMessage:"加密失败：检测到恶意代码，请求被拒绝"},{id:1008,username:"agent001",scriptName:"文件加密脚本",ip:"192.168.1.102",encryptStatus:"success",duration:456,submitTime:"2024-01-15 09:55:30",completeTime:"2024-01-15 09:55:31",estimatedCost:.6,actualCost:.58,fileSize:"3.4KB",algorithm:"文件加密",userAgent:"curl/7.68.0",encryptContent:"test.js file content...",encryptResult:"encrypted_file_base64_content...",errorMessage:""}],b=()=>{k.value=!0,setTimeout(()=>{P.value=M,V.value=M.length,k.value=!1},500)},W=()=>{f.currentPage=1,b()},q=()=>{Object.assign(m,{scriptName:"",ip:"",encryptStatus:"",dateRange:[]}),f.currentPage=1,b()},E=()=>{b()},H=()=>{C.info("导出功能开发中...")},O=s=>{if(s.encryptStatus==="success"&&s.encryptResult)try{const l=new Blob([s.encryptResult],{type:"application/octet-stream"}),S=window.URL.createObjectURL(l),d=document.createElement("a");d.href=S;const y=`${s.scriptName.replace(/\s+/g,"_")}_${s.id}.enc`;d.setAttribute("download",y),document.body.appendChild(d),d.click(),window.URL.revokeObjectURL(S),document.body.removeChild(d),C.success("文件下载已开始")}catch(l){console.error("下载文件时出错:",l),C.error("下载失败，请稍后重试")}else C.warning("没有可下载的加密结果")},J=s=>{Object.assign(o,s),R.value=!0},D=s=>{C.info(`查看脚本 ${s} 的详细信息`)},F=s=>{C.info(`查看IP ${s} 的地理位置和详细信息`)},B=s=>{switch(s){case"success":return"success";case"failed":return"danger";case"processing":return"warning";case"queued":return"info";default:return""}},A=s=>{switch(s){case"success":return"加密成功";case"failed":return"加密失败";case"processing":return"加密中";case"queued":return"队列中";default:return"未知"}},L=s=>s<100?"duration-fast":s<500?"duration-normal":s<1e3?"duration-slow":"duration-very-slow",G=s=>{f.pageSize=s,b()},X=s=>{f.currentPage=s,b()};return ue(()=>{b()}),(s,l)=>{const S=n("el-input"),d=n("el-form-item"),y=n("el-option"),Q=n("el-select"),Y=n("el-date-picker"),Z=n("Search"),T=n("el-icon"),h=n("el-button"),I=n("Refresh"),ee=n("el-form"),U=n("el-card"),te=n("Download"),_=n("el-table-column"),$=n("el-link"),K=n("el-tag"),ae=n("el-tooltip"),le=n("el-table"),se=n("el-pagination"),u=n("el-descriptions-item"),ne=n("el-alert"),oe=n("el-descriptions"),ie=n("el-dialog"),re=de("loading");return r(),p("div",me,[l[14]||(l[14]=g("h1",{class:"page-title"},"加密日志",-1)),e(U,{class:"search-card"},{default:t(()=>[e(ee,{model:m,inline:""},{default:t(()=>[e(d,{label:"脚本名称"},{default:t(()=>[e(S,{modelValue:m.scriptName,"onUpdate:modelValue":l[0]||(l[0]=a=>m.scriptName=a),placeholder:"请输入脚本名称",style:{width:"150px"},clearable:""},null,8,["modelValue"])]),_:1}),e(d,{label:"IP地址"},{default:t(()=>[e(S,{modelValue:m.ip,"onUpdate:modelValue":l[1]||(l[1]=a=>m.ip=a),placeholder:"请输入IP地址",style:{width:"150px"},clearable:""},null,8,["modelValue"])]),_:1}),e(d,{label:"加密状态"},{default:t(()=>[e(Q,{modelValue:m.encryptStatus,"onUpdate:modelValue":l[2]||(l[2]=a=>m.encryptStatus=a),placeholder:"全部状态",clearable:"",style:{width:"120px"}},{default:t(()=>[e(y,{label:"全部状态",value:""}),e(y,{label:"加密成功",value:"success"}),e(y,{label:"加密失败",value:"failed"}),e(y,{label:"队列中",value:"queued"}),e(y,{label:"加密中",value:"processing"})]),_:1},8,["modelValue"])]),_:1}),e(d,{label:"提交时间"},{default:t(()=>[e(Y,{modelValue:m.dateRange,"onUpdate:modelValue":l[3]||(l[3]=a=>m.dateRange=a),type:"datetimerange","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间",style:{width:"300px"},clearable:""},null,8,["modelValue"])]),_:1}),e(d,null,{default:t(()=>[g("div",_e,[e(h,{type:"primary",onClick:W,loading:k.value},{default:t(()=>[e(T,null,{default:t(()=>[e(Z)]),_:1}),l[8]||(l[8]=c(" 搜索 ",-1))]),_:1,__:[8]},8,["loading"]),e(h,{onClick:q},{default:t(()=>[e(T,null,{default:t(()=>[e(I)]),_:1}),l[9]||(l[9]=c(" 重置 ",-1))]),_:1,__:[9]})])]),_:1})]),_:1},8,["model"])]),_:1}),e(U,null,{header:t(()=>[g("div",ge,[g("span",null,"加密日志 (共 "+i(V.value)+" 条)",1),g("div",null,[e(h,{type:"primary",size:"small",onClick:E},{default:t(()=>[e(T,null,{default:t(()=>[e(I)]),_:1}),l[10]||(l[10]=c(" 刷新 ",-1))]),_:1,__:[10]}),e(h,{type:"success",size:"small",onClick:H},{default:t(()=>[e(T,null,{default:t(()=>[e(te)]),_:1}),l[11]||(l[11]=c(" 导出 ",-1))]),_:1,__:[11]})])])]),default:t(()=>[g("div",fe,[pe((r(),v(le,{data:P.value,stripe:"",style:{width:"100%"},"default-sort":{prop:"submitTime",order:"descending"},"table-layout":"fixed"},{default:t(()=>[e(_,{prop:"id",label:"ID",width:"80",sortable:"",align:"center"}),e(_,{prop:"scriptName",label:"脚本名称",width:"140",sortable:""},{default:t(({row:a})=>[e($,{type:"success",onClick:N=>D(a.scriptName)},{default:t(()=>[c(i(a.scriptName),1)]),_:2},1032,["onClick"])]),_:1}),e(_,{prop:"encryptStatus",label:"加密状态",width:"110",sortable:"",align:"center"},{default:t(({row:a})=>[e(K,{type:B(a.encryptStatus),size:"small"},{default:t(()=>[c(i(A(a.encryptStatus)),1)]),_:2},1032,["type"])]),_:1}),e(_,{prop:"estimatedCost",label:"预计费用",width:"110",sortable:"",align:"center"},{default:t(({row:a})=>[g("span",ye,"¥"+i(a.estimatedCost),1)]),_:1}),e(_,{prop:"actualCost",label:"实际费用",width:"110",sortable:"",align:"center"},{default:t(({row:a})=>[a.actualCost>0?(r(),p("span",be,"¥"+i(a.actualCost),1)):(r(),p("span",he,"-"))]),_:1}),e(_,{prop:"duration",label:"耗时",width:"100",sortable:"",align:"center"},{default:t(({row:a})=>[a.duration>0?(r(),p("span",{key:0,class:j(L(a.duration))},i(a.duration)+"ms ",3)):(r(),p("span",Ce,"-"))]),_:1}),e(_,{prop:"ip",label:"IP地址",width:"140",sortable:""},{default:t(({row:a})=>[e(ae,{content:`点击查看IP详情: ${a.ip}`,placement:"top"},{default:t(()=>[g("span",{class:"ip-address",onClick:N=>F(a.ip)},i(a.ip),9,Se)]),_:2},1032,["content"])]),_:1}),e(_,{prop:"submitTime",label:"提交时间",width:"160",sortable:""}),e(_,{prop:"completeTime",label:"完成时间",width:"160",sortable:""},{default:t(({row:a})=>[a.completeTime?(r(),p("span",ve,i(a.completeTime),1)):(r(),p("span",ke,"-"))]),_:1}),e(_,{label:"操作",width:"220",fixed:"right",align:"left"},{default:t(({row:a})=>[e(h,{type:"text",size:"small",onClick:N=>J(a)},{default:t(()=>l[12]||(l[12]=[c(" 详情 ",-1)])),_:2,__:[12]},1032,["onClick"]),a.encryptStatus==="success"&&a.encryptResult?(r(),v(h,{key:0,type:"text",size:"small",onClick:N=>O(a),style:{color:"#67c23a"}},{default:t(()=>l[13]||(l[13]=[c(" 下载 ",-1)])),_:2,__:[13]},1032,["onClick"])):x("",!0)]),_:1})]),_:1},8,["data"])),[[re,k.value]])]),g("div",Te,[e(se,{"current-page":f.currentPage,"onUpdate:currentPage":l[4]||(l[4]=a=>f.currentPage=a),"page-size":f.pageSize,"onUpdate:pageSize":l[5]||(l[5]=a=>f.pageSize=a),"page-sizes":[10,20,50,100],total:V.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:G,onCurrentChange:X},null,8,["current-page","page-size","total"])])]),_:1}),e(ie,{modelValue:R.value,"onUpdate:modelValue":l[7]||(l[7]=a=>R.value=a),title:"加密详情",width:"700px"},{default:t(()=>[e(oe,{column:2,border:""},{default:t(()=>[e(u,{label:"加密ID"},{default:t(()=>[c(i(o.id),1)]),_:1}),e(u,{label:"脚本名称"},{default:t(()=>[e($,{type:"success",onClick:l[6]||(l[6]=a=>D(o.scriptName))},{default:t(()=>[c(i(o.scriptName),1)]),_:1})]),_:1}),e(u,{label:"IP地址"},{default:t(()=>[c(i(o.ip),1)]),_:1}),e(u,{label:"提交时间"},{default:t(()=>[c(i(o.submitTime),1)]),_:1}),e(u,{label:"完成时间"},{default:t(()=>[c(i(o.completeTime||"-"),1)]),_:1}),e(u,{label:"加密状态"},{default:t(()=>[e(K,{type:B(o.encryptStatus)},{default:t(()=>[c(i(A(o.encryptStatus)),1)]),_:1},8,["type"])]),_:1}),e(u,{label:"耗时"},{default:t(()=>[o.duration>0?(r(),p("span",{key:0,class:j(L(o.duration))},i(o.duration)+"ms ",3)):(r(),p("span",ze,"-"))]),_:1}),e(u,{label:"预计费用"},{default:t(()=>[g("span",xe,"¥"+i(o.estimatedCost),1)]),_:1}),e(u,{label:"实际费用"},{default:t(()=>[o.actualCost>0?(r(),p("span",Re,"¥"+i(o.actualCost),1)):(r(),p("span",Ve,"-"))]),_:1}),o.fileSize?(r(),v(u,{key:0,label:"文件大小"},{default:t(()=>[c(i(o.fileSize),1)]),_:1})):x("",!0),o.algorithm?(r(),v(u,{key:1,label:"加密算法"},{default:t(()=>[c(i(o.algorithm),1)]),_:1})):x("",!0),o.errorMessage?(r(),v(u,{key:2,label:"错误信息",span:2},{default:t(()=>[e(ne,{title:o.errorMessage,type:"error",closable:!1,"show-icon":""},null,8,["title"])]),_:1})):x("",!0)]),_:1})]),_:1},8,["modelValue"])])}}},De=ce(Ne,[["__scopeId","data-v-dc1075dd"]]);export{De as default};
