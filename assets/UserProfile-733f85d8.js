import{r as d,a as b,b as f,o as N,c as $,d as s,e as a,w as l,y as A,t as w,f as T,ah as c}from"./index-9e8be50b.js";import{h as B}from"./My-b9727560.js";import{_ as Z}from"./_plugin-vue_export-helper-c27b6911.js";const O={class:"profile-page-mobile"},S={class:"content"},j={class:"user-info-card"},G={class:"user-details"},H={class:"username"},J={class:"menu-group"},K={class:"info-group"},M={class:"info-item"},Q={class:"info-desc"},W={class:"info-item"},X={class:"info-desc"},Y={class:"menu-group"},ee={class:"info-group"},se={class:"info-desc link"},ae={__name:"UserProfile",setup(oe){const _=d(!1),y=d(!1),g=d(!1),V=d(!1),P=d(!1),v=d(0),u=b({id:10001,username:"demo_user",email:"demo@example.com",avatar:"",registerTime:"2024-01-01 10:00:00",lastLoginTime:"2024-01-15 14:30:25",status:"active",balance:"1,234.56",memberLevel:"VIP会员",emailVerified:!0,phoneVerified:!0}),r=b({currentPassword:"",newPassword:"",confirmPassword:""}),t=b({newEmail:"",password:"",newEmailCode:""}),E=d(),C=d(),h={currentPassword:[{required:!0,message:"请输入当前密码"}],newPassword:[{required:!0,message:"请输入新密码"},{validator:n=>/.{6,20}/.test(n),message:"密码长度在 6 到 20 个字符"}],confirmPassword:[{required:!0,message:"请再次输入新密码"},{validator:n=>n===r.newPassword,message:"两次输入密码不一致"}]},x={newEmail:[{required:!0,message:"请输入新邮箱地址"},{validator:n=>/^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+$/.test(n),message:"请输入正确的邮箱地址"}],password:[{required:!0,message:"请输入登录密码"}],newEmailCode:[{required:!0,message:"请输入验证码"}]},q=()=>{r.currentPassword="",r.newPassword="",r.confirmPassword="",_.value=!0},z=async()=>{E.value.validate().then(async({valid:n,errors:e})=>{if(n){y.value=!0;try{await new Promise(i=>setTimeout(i,1e3)),c.success("密码修改成功"),_.value=!1}catch(i){console.error("密码修改失败:",i),c.fail("密码修改失败")}finally{y.value=!1}}})},F=()=>{t.newEmail="",t.password="",t.newEmailCode="",g.value=!0},R=async()=>{if(!t.newEmail){c.warn("请先输入新邮箱地址");return}try{P.value=!0,await new Promise(e=>setTimeout(e,1e3)),c.success("验证码已发送"),v.value=60;const n=setInterval(()=>{v.value--,v.value<=0&&clearInterval(n)},1e3)}catch{c.fail("发送失败，请重试")}finally{P.value=!1}},D=async()=>{C.value.validate().then(async({valid:n,errors:e})=>{if(n){V.value=!0;try{await new Promise(i=>setTimeout(i,1e3)),u.email=t.newEmail,c.success("邮箱修改成功"),g.value=!1}catch(i){console.error("邮箱修改失败:",i),c.fail("邮箱修改失败")}finally{V.value=!1}}})};return(n,e)=>{const i=f("nut-avatar"),I=f("nut-tag"),m=f("nut-input"),p=f("nut-form-item"),k=f("nut-form"),U=f("nut-dialog"),L=f("nut-button");return N(),$("div",O,[s("div",S,[s("div",j,[a(i,{size:"large"},{default:l(()=>[a(A(B))]),_:1}),s("div",G,[s("div",H,w(u.username),1),a(I,{type:"primary",size:"small"},{default:l(()=>[T(w(u.memberLevel),1)]),_:1})])]),s("div",J,[e[12]||(e[12]=s("div",{class:"menu-group-title"},"基本信息",-1)),s("div",K,[s("div",M,[e[10]||(e[10]=s("span",{class:"info-title"},"注册时间",-1)),s("span",Q,w(u.registerTime),1)]),s("div",W,[e[11]||(e[11]=s("span",{class:"info-title"},"最后登录",-1)),s("span",X,w(u.lastLoginTime),1)])])]),s("div",Y,[e[15]||(e[15]=s("div",{class:"menu-group-title"},"安全设置",-1)),s("div",ee,[s("div",{class:"info-item",onClick:q},e[13]||(e[13]=[s("span",{class:"info-title"},"登录密码",-1),s("span",{class:"info-desc link"},"修改",-1)])),s("div",{class:"info-item",onClick:F},[e[14]||(e[14]=s("span",{class:"info-title"},"邮箱地址",-1)),s("span",se,w(u.email),1)])])])]),a(U,{visible:_.value,"onUpdate:visible":e[3]||(e[3]=o=>_.value=o),title:"修改密码",onOk:z,onCancel:e[4]||(e[4]=o=>_.value=!1)},{default:l(()=>[a(k,{ref_key:"passwordFormRef",ref:E,"model-value":r,rules:h},{default:l(()=>[a(p,{label:"当前密码",prop:"currentPassword"},{default:l(()=>[a(m,{modelValue:r.currentPassword,"onUpdate:modelValue":e[0]||(e[0]=o=>r.currentPassword=o),type:"password",placeholder:"请输入当前密码"},null,8,["modelValue"])]),_:1}),a(p,{label:"新密码",prop:"newPassword"},{default:l(()=>[a(m,{modelValue:r.newPassword,"onUpdate:modelValue":e[1]||(e[1]=o=>r.newPassword=o),type:"password",placeholder:"请输入新密码"},null,8,["modelValue"])]),_:1}),a(p,{label:"确认密码",prop:"confirmPassword"},{default:l(()=>[a(m,{modelValue:r.confirmPassword,"onUpdate:modelValue":e[2]||(e[2]=o=>r.confirmPassword=o),type:"password",placeholder:"请再次输入新密码"},null,8,["modelValue"])]),_:1})]),_:1},8,["model-value"])]),_:1},8,["visible"]),a(U,{visible:g.value,"onUpdate:visible":e[8]||(e[8]=o=>g.value=o),title:"修改邮箱",onOk:D,onCancel:e[9]||(e[9]=o=>g.value=!1)},{default:l(()=>[a(k,{ref_key:"emailFormRef",ref:C,"model-value":t,rules:x},{default:l(()=>[a(p,{label:"当前邮箱"},{default:l(()=>[a(m,{"model-value":u.email,readonly:""},null,8,["model-value"])]),_:1}),a(p,{label:"新邮箱",prop:"newEmail"},{default:l(()=>[a(m,{modelValue:t.newEmail,"onUpdate:modelValue":e[5]||(e[5]=o=>t.newEmail=o),placeholder:"请输入新邮箱地址"},null,8,["modelValue"])]),_:1}),a(p,{label:"登录密码",prop:"password"},{default:l(()=>[a(m,{modelValue:t.password,"onUpdate:modelValue":e[6]||(e[6]=o=>t.password=o),type:"password",placeholder:"请输入登录密码验证"},null,8,["modelValue"])]),_:1}),a(p,{label:"验证码",prop:"newEmailCode"},{default:l(()=>[a(m,{modelValue:t.newEmailCode,"onUpdate:modelValue":e[7]||(e[7]=o=>t.newEmailCode=o),placeholder:"请输入验证码",class:"verification-input"},{right:l(()=>[a(L,{size:"small",type:"primary",disabled:!t.newEmail||P.value||v.value>0,loading:P.value,onClick:R},{default:l(()=>[T(w(v.value>0?`${v.value}s`:"发送"),1)]),_:1},8,["disabled","loading"])]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model-value"])]),_:1},8,["visible"])])}}},re=Z(ae,[["__scopeId","data-v-37bc363e"]]);export{re as default};
