import{_ as _e}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{r as N,a as M,l as fe,c as _,o as c,d as f,e,w as t,b as o,S as ge,f as r,s as ye,i as z,t as i,n as E,p as R,T as W,E as g}from"./index-BEccWB-n.js";const be={class:"encrypt-logs"},Ce={class:"button-group"},he={class:"card-header"},ve={class:"table-container"},Se={class:"cost-text"},ke={key:0,class:"cost-text actual-cost"},Te={key:1,class:"text-muted"},xe={key:1,class:"text-muted"},ze=["onClick"],Ve={key:0},we={key:1,class:"text-muted"},Ne={class:"pagination-container"},Re={key:1},Pe={class:"cost-text"},Me={key:0,class:"cost-text actual-cost"},De={key:1},Be={__name:"Logs",setup($e){const V=N(!1),P=N(!1),S=N(0),n=M({id:null,username:"",scriptName:"",ip:"",encryptStatus:"",duration:0,submitTime:"",completeTime:"",estimatedCost:0,actualCost:0,fileSize:"",algorithm:"",userAgent:"",encryptContent:"",encryptResult:"",errorMessage:""}),d=M({username:"",scriptName:"",ip:"",encryptStatus:"",dateRange:[]}),y=M({currentPage:1,pageSize:20}),k=N([]),D=[{id:1001,username:"admin",scriptName:"PHP加密脚本",ip:"192.168.1.100",encryptStatus:"success",duration:235,submitTime:"2024-01-15 10:30:25",completeTime:"2024-01-15 10:30:26",estimatedCost:.5,actualCost:.45,fileSize:"2.3KB",algorithm:"标准加密 V1",userAgent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36",encryptContent:'<?php echo "Hello World"; ?>',encryptResult:"base64_encoded_encrypted_content_here...",errorMessage:""},{id:1002,username:"user001",scriptName:"JS混淆脚本",ip:"192.168.1.101",encryptStatus:"success",duration:189,submitTime:"2024-01-15 10:25:15",completeTime:"2024-01-15 10:25:16",estimatedCost:.3,actualCost:.28,fileSize:"1.8KB",algorithm:"超级加密 V3",userAgent:"PostmanRuntime/7.32.3",encryptContent:"function test() { return true; }",encryptResult:"obfuscated_js_code_here...",errorMessage:""},{id:1003,username:"agent001",scriptName:"PHP加密脚本",ip:"192.168.1.102",encryptStatus:"failed",duration:312,submitTime:"2024-01-15 10:20:05",completeTime:"2024-01-15 10:20:06",estimatedCost:.4,actualCost:0,fileSize:"0KB",algorithm:"标准加密 V1",userAgent:"curl/7.68.0",encryptContent:"",encryptResult:"",errorMessage:"加密失败：代码内容不能为空"},{id:1004,username:"user002",scriptName:"文件加密脚本",ip:"192.168.1.103",encryptStatus:"processing",duration:0,submitTime:"2024-01-15 10:15:30",completeTime:"",estimatedCost:1.2,actualCost:0,fileSize:"5.6MB",algorithm:"文件加密",userAgent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36",encryptContent:"large_file_content...",encryptResult:"",errorMessage:""},{id:1005,username:"user003",scriptName:"JS混淆脚本",ip:"192.168.1.104",encryptStatus:"queued",duration:0,submitTime:"2024-01-15 10:10:20",completeTime:"",estimatedCost:.35,actualCost:0,fileSize:"2.1KB",algorithm:"超级加密 V3",userAgent:"Python-requests/2.28.1",encryptContent:'console.log("test");',encryptResult:"",errorMessage:""},{id:1006,username:"user001",scriptName:"PHP加密脚本",ip:"192.168.1.101",encryptStatus:"failed",duration:1250,submitTime:"2024-01-15 10:05:10",completeTime:"2024-01-15 10:05:12",estimatedCost:.8,actualCost:0,fileSize:"4.2KB",algorithm:"超级加密 V3",userAgent:"PostmanRuntime/7.32.3",encryptContent:"very long php code content...",encryptResult:"",errorMessage:"加密失败：服务器内部错误，内存不足"},{id:1007,username:"hacker",scriptName:"PHP加密脚本",ip:"192.168.1.105",encryptStatus:"failed",duration:89,submitTime:"2024-01-15 10:00:05",completeTime:"2024-01-15 10:00:06",estimatedCost:.25,actualCost:0,fileSize:"1.1KB",algorithm:"标准加密 V1",userAgent:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7)",encryptContent:"<?php system($_GET['cmd']); ?>",encryptResult:"",errorMessage:"加密失败：检测到恶意代码，请求被拒绝"},{id:1008,username:"agent001",scriptName:"文件加密脚本",ip:"192.168.1.102",encryptStatus:"success",duration:456,submitTime:"2024-01-15 09:55:30",completeTime:"2024-01-15 09:55:31",estimatedCost:.6,actualCost:.58,fileSize:"3.4KB",algorithm:"文件加密",userAgent:"curl/7.68.0",encryptContent:"test.js file content...",encryptResult:"encrypted_file_base64_content...",errorMessage:""}],v=()=>{V.value=!0,setTimeout(()=>{k.value=D,S.value=D.length,V.value=!1},500)},q=()=>{y.currentPage=1,v()},H=()=>{Object.assign(d,{username:"",scriptName:"",ip:"",encryptStatus:"",dateRange:[]}),y.currentPage=1,v()},O=()=>{v()},J=async()=>{try{await W.confirm("确定要清空所有加密日志吗？此操作不可恢复！","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),k.value=[],S.value=0,g.success("日志清空成功")}catch{}},F=()=>{g.info("导出功能开发中...")},G=s=>{if(s.encryptStatus==="success"&&s.encryptResult)try{const a=new Blob([s.encryptResult],{type:"application/octet-stream"}),b=window.URL.createObjectURL(a),p=document.createElement("a");p.href=b;const h=`${s.scriptName.replace(/\s+/g,"_")}_${s.id}.enc`;p.setAttribute("download",h),document.body.appendChild(p),p.click(),window.URL.revokeObjectURL(b),document.body.removeChild(p),g.success("文件下载已开始")}catch(a){console.error("下载文件时出错:",a),g.error("下载失败，请稍后重试")}else g.warning("没有可下载的加密结果")},X=s=>{Object.assign(n,s),P.value=!0},Q=async s=>{try{await W.confirm(`确定要删除ID为 ${s.id} 的加密日志吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const a=k.value.findIndex(b=>b.id===s.id);a>-1&&(k.value.splice(a,1),S.value--,g.success("删除成功"))}catch{}},B=s=>{g.info(`查看用户 ${s} 的详细信息`)},$=s=>{g.info(`查看脚本 ${s} 的详细信息`)},Y=s=>{g.info(`查看IP ${s} 的地理位置和详细信息`)},I=s=>{switch(s){case"success":return"success";case"failed":return"danger";case"processing":return"warning";case"queued":return"info";default:return""}},U=s=>{switch(s){case"success":return"加密成功";case"failed":return"加密失败";case"processing":return"加密中";case"queued":return"队列中";default:return"未知"}},A=s=>s<100?"duration-fast":s<500?"duration-normal":s<1e3?"duration-slow":"duration-very-slow",Z=s=>{y.pageSize=s,v()},ee=s=>{y.currentPage=s,v()};return fe(()=>{v()}),(s,a)=>{const b=o("el-input"),p=o("el-form-item"),h=o("el-option"),te=o("el-select"),le=o("el-date-picker"),ae=o("Search"),T=o("el-icon"),C=o("el-button"),L=o("Refresh"),se=o("Delete"),ne=o("el-form"),K=o("el-card"),oe=o("Download"),m=o("el-table-column"),w=o("el-link"),j=o("el-tag"),ie=o("el-tooltip"),re=o("el-table"),ce=o("el-pagination"),u=o("el-descriptions-item"),ue=o("el-alert"),de=o("el-descriptions"),pe=o("el-dialog"),me=ge("loading");return c(),_("div",be,[a[18]||(a[18]=f("h1",{class:"page-title"},"加密日志",-1)),e(K,{class:"search-card"},{default:t(()=>[e(ne,{model:d,inline:""},{default:t(()=>[e(p,{label:"用户名"},{default:t(()=>[e(b,{modelValue:d.username,"onUpdate:modelValue":a[0]||(a[0]=l=>d.username=l),placeholder:"请输入用户名",style:{width:"150px"},clearable:""},null,8,["modelValue"])]),_:1}),e(p,{label:"脚本名称"},{default:t(()=>[e(b,{modelValue:d.scriptName,"onUpdate:modelValue":a[1]||(a[1]=l=>d.scriptName=l),placeholder:"请输入脚本名称",style:{width:"150px"},clearable:""},null,8,["modelValue"])]),_:1}),e(p,{label:"IP地址"},{default:t(()=>[e(b,{modelValue:d.ip,"onUpdate:modelValue":a[2]||(a[2]=l=>d.ip=l),placeholder:"请输入IP地址",style:{width:"150px"},clearable:""},null,8,["modelValue"])]),_:1}),e(p,{label:"加密状态"},{default:t(()=>[e(te,{modelValue:d.encryptStatus,"onUpdate:modelValue":a[3]||(a[3]=l=>d.encryptStatus=l),placeholder:"全部状态",clearable:"",style:{width:"120px"}},{default:t(()=>[e(h,{label:"全部状态",value:""}),e(h,{label:"加密成功",value:"success"}),e(h,{label:"加密失败",value:"failed"}),e(h,{label:"队列中",value:"queued"}),e(h,{label:"加密中",value:"processing"})]),_:1},8,["modelValue"])]),_:1}),e(p,{label:"提交时间"},{default:t(()=>[e(le,{modelValue:d.dateRange,"onUpdate:modelValue":a[4]||(a[4]=l=>d.dateRange=l),type:"datetimerange","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间",style:{width:"300px"},clearable:""},null,8,["modelValue"])]),_:1}),e(p,null,{default:t(()=>[f("div",Ce,[e(C,{type:"primary",onClick:q,loading:V.value},{default:t(()=>[e(T,null,{default:t(()=>[e(ae)]),_:1}),a[10]||(a[10]=r(" 搜索 ",-1))]),_:1,__:[10]},8,["loading"]),e(C,{onClick:H},{default:t(()=>[e(T,null,{default:t(()=>[e(L)]),_:1}),a[11]||(a[11]=r(" 重置 ",-1))]),_:1,__:[11]}),e(C,{type:"danger",onClick:J},{default:t(()=>[e(T,null,{default:t(()=>[e(se)]),_:1}),a[12]||(a[12]=r(" 清空日志 ",-1))]),_:1,__:[12]})])]),_:1})]),_:1},8,["model"])]),_:1}),e(K,null,{header:t(()=>[f("div",he,[f("span",null,"加密日志 (共 "+i(S.value)+" 条)",1),f("div",null,[e(C,{type:"primary",size:"small",onClick:O},{default:t(()=>[e(T,null,{default:t(()=>[e(L)]),_:1}),a[13]||(a[13]=r(" 刷新 ",-1))]),_:1,__:[13]}),e(C,{type:"success",size:"small",onClick:F},{default:t(()=>[e(T,null,{default:t(()=>[e(oe)]),_:1}),a[14]||(a[14]=r(" 导出 ",-1))]),_:1,__:[14]})])])]),default:t(()=>[f("div",ve,[ye((c(),z(re,{data:k.value,stripe:"",style:{width:"100%"},"default-sort":{prop:"submitTime",order:"descending"},"table-layout":"fixed"},{default:t(()=>[e(m,{prop:"id",label:"ID",width:"80",sortable:"",align:"center"}),e(m,{prop:"username",label:"用户名",width:"110",sortable:""},{default:t(({row:l})=>[e(w,{type:"primary",onClick:x=>B(l.username)},{default:t(()=>[r(i(l.username),1)]),_:2},1032,["onClick"])]),_:1}),e(m,{prop:"scriptName",label:"脚本名称",width:"140",sortable:""},{default:t(({row:l})=>[e(w,{type:"success",onClick:x=>$(l.scriptName)},{default:t(()=>[r(i(l.scriptName),1)]),_:2},1032,["onClick"])]),_:1}),e(m,{prop:"encryptStatus",label:"加密状态",width:"110",sortable:"",align:"center"},{default:t(({row:l})=>[e(j,{type:I(l.encryptStatus),size:"small"},{default:t(()=>[r(i(U(l.encryptStatus)),1)]),_:2},1032,["type"])]),_:1}),e(m,{prop:"estimatedCost",label:"预计费用",width:"110",sortable:"",align:"center"},{default:t(({row:l})=>[f("span",Se,"¥"+i(l.estimatedCost),1)]),_:1}),e(m,{prop:"actualCost",label:"实际费用",width:"110",sortable:"",align:"center"},{default:t(({row:l})=>[l.actualCost>0?(c(),_("span",ke,"¥"+i(l.actualCost),1)):(c(),_("span",Te,"-"))]),_:1}),e(m,{prop:"duration",label:"耗时",width:"100",sortable:"",align:"center"},{default:t(({row:l})=>[l.duration>0?(c(),_("span",{key:0,class:E(A(l.duration))},i(l.duration)+"ms ",3)):(c(),_("span",xe,"-"))]),_:1}),e(m,{prop:"ip",label:"IP地址",width:"140",sortable:""},{default:t(({row:l})=>[e(ie,{content:`点击查看IP详情: ${l.ip}`,placement:"top"},{default:t(()=>[f("span",{class:"ip-address",onClick:x=>Y(l.ip)},i(l.ip),9,ze)]),_:2},1032,["content"])]),_:1}),e(m,{prop:"submitTime",label:"提交时间",width:"160",sortable:""}),e(m,{prop:"completeTime",label:"完成时间",width:"160",sortable:""},{default:t(({row:l})=>[l.completeTime?(c(),_("span",Ve,i(l.completeTime),1)):(c(),_("span",we,"-"))]),_:1}),e(m,{label:"操作",width:"220",fixed:"right",align:"left"},{default:t(({row:l})=>[e(C,{type:"text",size:"small",onClick:x=>X(l)},{default:t(()=>a[15]||(a[15]=[r(" 详情 ",-1)])),_:2,__:[15]},1032,["onClick"]),l.encryptStatus==="success"&&l.encryptResult?(c(),z(C,{key:0,type:"text",size:"small",onClick:x=>G(l),style:{color:"#67c23a"}},{default:t(()=>a[16]||(a[16]=[r(" 下载 ",-1)])),_:2,__:[16]},1032,["onClick"])):R("",!0),e(C,{type:"text",size:"small",onClick:x=>Q(l),style:{color:"#f56c6c"}},{default:t(()=>a[17]||(a[17]=[r(" 删除 ",-1)])),_:2,__:[17]},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[me,V.value]])]),f("div",Ne,[e(ce,{"current-page":y.currentPage,"onUpdate:currentPage":a[5]||(a[5]=l=>y.currentPage=l),"page-size":y.pageSize,"onUpdate:pageSize":a[6]||(a[6]=l=>y.pageSize=l),"page-sizes":[10,20,50,100],total:S.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:Z,onCurrentChange:ee},null,8,["current-page","page-size","total"])])]),_:1}),e(pe,{modelValue:P.value,"onUpdate:modelValue":a[9]||(a[9]=l=>P.value=l),title:"加密详情",width:"700px"},{default:t(()=>[e(de,{column:2,border:""},{default:t(()=>[e(u,{label:"加密ID"},{default:t(()=>[r(i(n.id),1)]),_:1}),e(u,{label:"用户名"},{default:t(()=>[e(w,{type:"primary",onClick:a[7]||(a[7]=l=>B(n.username))},{default:t(()=>[r(i(n.username),1)]),_:1})]),_:1}),e(u,{label:"脚本名称"},{default:t(()=>[e(w,{type:"success",onClick:a[8]||(a[8]=l=>$(n.scriptName))},{default:t(()=>[r(i(n.scriptName),1)]),_:1})]),_:1}),e(u,{label:"IP地址"},{default:t(()=>[r(i(n.ip),1)]),_:1}),e(u,{label:"提交时间"},{default:t(()=>[r(i(n.submitTime),1)]),_:1}),e(u,{label:"完成时间"},{default:t(()=>[r(i(n.completeTime||"-"),1)]),_:1}),e(u,{label:"加密状态"},{default:t(()=>[e(j,{type:I(n.encryptStatus)},{default:t(()=>[r(i(U(n.encryptStatus)),1)]),_:1},8,["type"])]),_:1}),e(u,{label:"耗时"},{default:t(()=>[n.duration>0?(c(),_("span",{key:0,class:E(A(n.duration))},i(n.duration)+"ms ",3)):(c(),_("span",Re,"-"))]),_:1}),e(u,{label:"预计费用"},{default:t(()=>[f("span",Pe,"¥"+i(n.estimatedCost),1)]),_:1}),e(u,{label:"实际费用"},{default:t(()=>[n.actualCost>0?(c(),_("span",Me,"¥"+i(n.actualCost),1)):(c(),_("span",De,"-"))]),_:1}),n.fileSize?(c(),z(u,{key:0,label:"文件大小"},{default:t(()=>[r(i(n.fileSize),1)]),_:1})):R("",!0),n.algorithm?(c(),z(u,{key:1,label:"加密算法"},{default:t(()=>[r(i(n.algorithm),1)]),_:1})):R("",!0),n.errorMessage?(c(),z(u,{key:2,label:"错误信息",span:2},{default:t(()=>[e(ue,{title:n.errorMessage,type:"error",closable:!1,"show-icon":""},null,8,["title"])]),_:1})):R("",!0)]),_:1})]),_:1},8,["modelValue"])])}}},Ae=_e(Be,[["__scopeId","data-v-be6449e9"]]);export{Ae as default};
