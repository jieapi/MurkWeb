import{_ as le}from"./_plugin-vue_export-helper-c27b6911.js";import{r as h,a as V,l as ae,b as o,R as oe,o as x,c as ne,d as _,e,w as t,f as s,v as se,i as D,t as r,q as ie,E as P,T as re}from"./index-61ad50a9.js";const pe={class:"website-logs"},de={class:"card-header"},ue={class:"pagination-container"},ce={class:"log-details"},_e={__name:"Logs",setup(me){const m=h(!1),k=h(!1),w=h(0),i=V({id:null,type:"",content:"",operator:"",ip:"",userAgent:"",time:"",result:"",details:""}),p=V({type:"",operator:"",ip:"",dateRange:[]}),u=V({currentPage:1,pageSize:20}),C=h([]),z=[{id:1,type:"login",content:"用户登录系统",operator:"admin",ip:"192.168.1.100",userAgent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",time:"2024-01-15 10:30:25",result:"success",details:`登录IP: 192.168.1.100
登录设备: Windows 10
浏览器: Chrome 120`},{id:2,type:"update",content:"修改网站基本信息",operator:"admin",ip:"192.168.1.100",userAgent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",time:"2024-01-15 10:45:15",result:"success",details:"修改项: 网站名称, 网站描述"},{id:3,type:"register",content:"新用户注册",operator:"user005",ip:"192.168.1.101",userAgent:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/16.0 Safari/605.1.15",time:"2024-01-15 11:20:05",result:"success",details:`注册方式: 邮箱
邮箱: user005@example.com`},{id:4,type:"delete",content:"删除用户",operator:"admin",ip:"192.168.1.100",userAgent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",time:"2024-01-15 11:45:30",result:"success",details:`删除用户: user006
删除原因: 违规操作`},{id:5,type:"other",content:"系统备份",operator:"system",ip:"127.0.0.1",userAgent:"System Backup Service",time:"2024-01-15 12:00:00",result:"success",details:`备份文件: backup_20240115120000.zip
备份大小: 256MB`},{id:6,type:"login",content:"用户登录失败",operator:"unknown",ip:"192.168.1.102",userAgent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36",time:"2024-01-15 12:15:10",result:"failed",details:`登录IP: 192.168.1.102
失败原因: 密码错误
尝试次数: 3`}],g=()=>{m.value=!0,setTimeout(()=>{C.value=z,w.value=z.length,m.value=!1},500)},I=()=>{u.currentPage=1,g()},K=()=>{Object.assign(p,{type:"",operator:"",ip:"",dateRange:[]}),u.currentPage=1,g()},B=()=>{g()},R=()=>{P.success("日志导出成功")},N=async()=>{try{await re.confirm("确定要清空所有日志吗？此操作不可恢复！","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),m.value=!0,setTimeout(()=>{C.value=[],w.value=0,m.value=!1,P.success("日志已清空")},1e3)}catch{}},U=n=>{Object.assign(i,n),k.value=!0},G=n=>{u.pageSize=n,g()},H=n=>{u.currentPage=n,g()},S=n=>({login:"primary",register:"success",update:"warning",delete:"danger",other:"info"})[n]||"",T=n=>({login:"登录",register:"注册",update:"修改",delete:"删除",other:"其他"})[n]||n,E=n=>n.length>30?n.substring(0,30)+"...":n;return ae(()=>{g()}),(n,l)=>{const f=o("el-option"),Y=o("el-select"),y=o("el-form-item"),L=o("el-input"),j=o("el-date-picker"),O=o("Search"),v=o("el-icon"),b=o("el-button"),A=o("Refresh"),q=o("el-form"),W=o("el-card"),F=o("Download"),X=o("Delete"),c=o("el-table-column"),M=o("el-tag"),$=o("el-tooltip"),J=o("el-table"),Q=o("el-pagination"),d=o("el-descriptions-item"),Z=o("el-descriptions"),ee=o("el-dialog"),te=oe("loading");return x(),ne("div",pe,[l[14]||(l[14]=_("h1",{class:"page-title"},"网站日志",-1)),e(W,{class:"search-card"},{default:t(()=>[e(q,{model:p,inline:""},{default:t(()=>[e(y,{label:"操作类型"},{default:t(()=>[e(Y,{modelValue:p.type,"onUpdate:modelValue":l[0]||(l[0]=a=>p.type=a),placeholder:"全部操作类型",clearable:"",style:{width:"120px"}},{default:t(()=>[e(f,{label:"全部操作类型",value:""}),e(f,{label:"登录",value:"login"}),e(f,{label:"注册",value:"register"}),e(f,{label:"修改",value:"update"}),e(f,{label:"删除",value:"delete"}),e(f,{label:"其他",value:"other"})]),_:1},8,["modelValue"])]),_:1}),e(y,{label:"操作人"},{default:t(()=>[e(L,{modelValue:p.operator,"onUpdate:modelValue":l[1]||(l[1]=a=>p.operator=a),placeholder:"请输入操作人",style:{width:"200px"},clearable:""},null,8,["modelValue"])]),_:1}),e(y,{label:"IP地址"},{default:t(()=>[e(L,{modelValue:p.ip,"onUpdate:modelValue":l[2]||(l[2]=a=>p.ip=a),placeholder:"请输入IP地址",style:{width:"200px"},clearable:""},null,8,["modelValue"])]),_:1}),e(y,{label:"操作时间"},{default:t(()=>[e(j,{modelValue:p.dateRange,"onUpdate:modelValue":l[3]||(l[3]=a=>p.dateRange=a),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1}),e(y,null,{default:t(()=>[e(b,{type:"primary",onClick:I,loading:m.value},{default:t(()=>[e(v,null,{default:t(()=>[e(O)]),_:1}),l[7]||(l[7]=s(" 搜索 ",-1))]),_:1,__:[7]},8,["loading"]),e(b,{onClick:K},{default:t(()=>[e(v,null,{default:t(()=>[e(A)]),_:1}),l[8]||(l[8]=s(" 重置 ",-1))]),_:1,__:[8]})]),_:1})]),_:1},8,["model"])]),_:1}),e(W,null,{header:t(()=>[_("div",de,[l[12]||(l[12]=_("span",null,"系统日志列表",-1)),_("div",null,[e(b,{type:"primary",size:"small",onClick:B},{default:t(()=>[e(v,null,{default:t(()=>[e(A)]),_:1}),l[9]||(l[9]=s(" 刷新 ",-1))]),_:1,__:[9]}),e(b,{type:"success",size:"small",onClick:R},{default:t(()=>[e(v,null,{default:t(()=>[e(F)]),_:1}),l[10]||(l[10]=s(" 导出日志 ",-1))]),_:1,__:[10]}),e(b,{type:"danger",size:"small",onClick:N},{default:t(()=>[e(v,null,{default:t(()=>[e(X)]),_:1}),l[11]||(l[11]=s(" 清空日志 ",-1))]),_:1,__:[11]})])])]),default:t(()=>[se((x(),D(J,{data:C.value,stripe:"",style:{width:"100%"}},{default:t(()=>[e(c,{prop:"id",label:"ID",width:"80"}),e(c,{prop:"type",label:"操作类型",width:"100"},{default:t(({row:a})=>[e(M,{type:S(a.type)},{default:t(()=>[s(r(T(a.type)),1)]),_:2},1032,["type"])]),_:1}),e(c,{prop:"content",label:"操作内容","min-width":"200"}),e(c,{prop:"operator",label:"操作人",width:"120"}),e(c,{prop:"ip",label:"IP地址",width:"140"}),e(c,{prop:"userAgent",label:"浏览器",width:"180"},{default:t(({row:a})=>[e($,{content:a.userAgent,placement:"top"},{default:t(()=>[_("span",null,r(E(a.userAgent)),1)]),_:2},1032,["content"])]),_:1}),e(c,{prop:"time",label:"操作时间",width:"160"}),e(c,{label:"操作",width:"100",fixed:"right"},{default:t(({row:a})=>[e(b,{type:"primary",size:"small",onClick:ge=>U(a)},{default:t(()=>l[13]||(l[13]=[s(" 详情 ",-1)])),_:2,__:[13]},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[te,m.value]]),_("div",ue,[e(Q,{"current-page":u.currentPage,"onUpdate:currentPage":l[4]||(l[4]=a=>u.currentPage=a),"page-size":u.pageSize,"onUpdate:pageSize":l[5]||(l[5]=a=>u.pageSize=a),"page-sizes":[10,20,50,100],total:w.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:G,onCurrentChange:H},null,8,["current-page","page-size","total"])])]),_:1}),e(ee,{modelValue:k.value,"onUpdate:modelValue":l[6]||(l[6]=a=>k.value=a),title:"日志详情",width:"600px"},{default:t(()=>[e(Z,{column:1,border:""},{default:t(()=>[e(d,{label:"ID"},{default:t(()=>[s(r(i.id),1)]),_:1}),e(d,{label:"操作类型"},{default:t(()=>[e(M,{type:S(i.type)},{default:t(()=>[s(r(T(i.type)),1)]),_:1},8,["type"])]),_:1}),e(d,{label:"操作内容"},{default:t(()=>[s(r(i.content),1)]),_:1}),e(d,{label:"操作人"},{default:t(()=>[s(r(i.operator),1)]),_:1}),e(d,{label:"IP地址"},{default:t(()=>[s(r(i.ip),1)]),_:1}),e(d,{label:"浏览器"},{default:t(()=>[s(r(i.userAgent),1)]),_:1}),e(d,{label:"操作时间"},{default:t(()=>[s(r(i.time),1)]),_:1}),e(d,{label:"操作结果"},{default:t(()=>[e(M,{type:i.result==="success"?"success":"danger"},{default:t(()=>[s(r(i.result==="success"?"成功":"失败"),1)]),_:1},8,["type"])]),_:1}),i.details?(x(),D(d,{key:0,label:"详细信息"},{default:t(()=>[_("pre",ce,r(i.details),1)]),_:1})):ie("",!0)]),_:1})]),_:1},8,["modelValue"])])}}},ye=le(_e,[["__scopeId","data-v-e9bd63a9"]]);export{ye as default};
