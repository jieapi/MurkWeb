import{a8 as $,a9 as H,o as n,c as r,n as I,s as F,d as s,r as c,a as D,b,e as l,y as p,aa as fe,ab as ge,ac as _e,t as a,p as ye,ad as be,w as m,f as V,F as Ce,h as he,q as T,ae as we,af as z}from"./index-9e8be50b.js";import{_ as ke}from"./_plugin-vue_export-helper-c27b6911.js";const ze=H("arrow-right"),Se=s("path",{d:"m387.547 980.846 305.006-397.532a117.102 117.102 0 0 0 0-142.628L387.584 43.154a44.837 44.837 0 0 0-71.131 54.492l305.042 397.568a27.538 27.538 0 0 1 0 33.572L316.489 926.318a44.8 44.8 0 0 0 71.058 54.564",fill:"currentColor","fill-opacity":"0.9"},null,-1),Ve=[Se];function Te(f,C,d,h,_,y){return n(),r("svg",{class:I(f.classes),style:F(f.style),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024",role:"presentation"},Ve,6)}const P=$(ze,[["render",Te]]),xe=H("order"),Me=s("path",{d:"M751.543 1024H268.8c-128 0-234.057-109.714-234.057-241.371V362.057c0-135.314 106.057-241.371 234.057-241.371V230.4c-69.486-3.657-124.343 58.514-124.343 131.657V782.63c0 73.142 54.857 131.657 124.343 131.657h486.4c65.829 0 124.343-58.515 124.343-131.657V362.057c0-73.143-54.857-131.657-124.343-131.657V120.686c128 0 234.057 109.714 234.057 241.371V782.63C985.6 914.286 883.2 1024 751.543 1024zM601.6 329.143H418.743c-91.429 0-164.572-73.143-164.572-164.572S327.314 0 418.743 0H601.6c91.429 0 164.571 73.143 164.571 164.571S693.03 329.143 601.6 329.143zM418.743 109.714c-29.257 0-54.857 25.6-54.857 54.857s25.6 54.858 54.857 54.858H601.6c29.257 0 54.857-25.6 54.857-54.858s-25.6-54.857-54.857-54.857H418.743zM601.6 768H418.743c-29.257 0-54.857-25.6-54.857-54.857s25.6-54.857 54.857-54.857H601.6c29.257 0 54.857 25.6 54.857 54.857S630.857 768 601.6 768zm0-182.857H418.743c-29.257 0-54.857-25.6-54.857-54.857s25.6-54.857 54.857-54.857H601.6c29.257 0 54.857 25.6 54.857 54.857s-25.6 54.857-54.857 54.857z",fill:"currentColor","fill-opacity":"0.9"},null,-1),Ne=[Me];function Be(f,C,d,h,_,y){return n(),r("svg",{class:I(f.classes),style:F(f.style),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024",role:"presentation"},Ne,6)}const Q=$(xe,[["render",Be]]),De=H("setting"),Pe=s("path",{d:"M512 1021.305c-24.253 0-51.2-5.39-75.453-18.863l-309.894-158.99c-53.895-26.947-86.232-83.536-86.232-142.82V323.368c0-61.979 32.337-115.873 86.232-142.82l309.894-158.99c45.81-24.253 102.4-24.253 148.21 0l309.896 158.99c53.894 26.947 86.231 83.536 86.231 142.82v377.264c0 61.979-32.337 115.873-86.231 142.82l-309.895 158.99c-21.558 13.474-48.505 18.863-72.758 18.863zm0-937.768c-13.474 0-24.253 2.695-37.726 8.084l-309.895 158.99c-26.947 13.473-43.116 43.115-43.116 72.757v377.264c0 29.642 16.169 56.59 43.116 72.757l309.895 158.99c24.252 10.779 51.2 10.779 75.452 0l309.895-158.99c26.947-13.473 43.116-40.42 43.116-72.757V323.368c0-29.642-16.169-56.59-43.116-72.757L549.726 91.62c-13.473-5.39-24.252-8.084-37.726-8.084zm0 644.042c-110.484 0-202.105-91.621-202.105-202.105S401.515 323.368 512 323.368s202.105 91.621 202.105 202.106S622.485 727.579 512 727.579zm0-323.368c-67.368 0-121.263 53.894-121.263 121.263S444.632 646.737 512 646.737s121.263-53.895 121.263-121.263S579.368 404.21 512 404.21z",fill:"currentColor","fill-opacity":"0.9"},null,-1),$e=[Pe];function He(f,C,d,h,_,y){return n(),r("svg",{class:I(f.classes),style:F(f.style),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024",role:"presentation"},$e,6)}const W=$(De,[["render",He]]);const Ie={class:"encrypt-page"},Fe={class:"upload-section"},Ue={class:"section-title"},Le={key:0,class:"upload-placeholder"},Oe={key:1,class:"file-selected"},Ae={class:"file-icon"},Ee={class:"file-info"},Re={class:"file-name"},Je={class:"file-size"},qe={class:"config-section"},Ge={class:"section-title"},Ke={class:"config-value"},je={class:"config-value"},Qe={class:"restriction-section"},We={class:"section-title"},Xe={class:"restriction-item"},Ye={class:"restriction-item"},Ze={class:"config-value"},es={class:"encrypt-button"},ss={class:"records-section"},ts={class:"section-title"},ls={class:"records-list"},os=["onClick"],as={class:"record-info"},is={class:"record-name"},ns={class:"record-time"},rs={class:"record-status"},cs={key:0,class:"empty-records"},ds={class:"progress-content"},us={class:"progress-icon"},ps={class:"progress-text"},vs={class:"progress-bar"},ms={class:"progress-percent"},fs={class:"progress-file"},gs={class:"file-name"},_s={class:"file-size"},ys={key:0,class:"record-detail"},bs={class:"detail-row"},Cs={class:"detail-value"},hs={class:"detail-row"},ws={class:"detail-value"},ks={class:"detail-row"},zs={class:"detail-row"},Ss={class:"detail-value"},Vs={key:0,class:"detail-row"},Ts={class:"detail-value"},xs={class:"detail-row"},Ms={class:"detail-value cost"},Ns={key:1,class:"detail-row"},Bs={class:"detail-value cost actual"},Ds={key:2,class:"detail-row"},Ps={class:"detail-value error"},$s={key:0,class:"dialog-footer"},Hs={key:0,class:"action-buttons"},Is={key:1,class:"single-action"},Fs=".php,.zip",Us={__name:"encrypt",setup(f){const C=c(null),d=c(null),h=c(!1),_=c(!1),y=c(!1),N=c(!1),U=c(new Date),x=c(!1),S=c(!1),i=c(null),X=c(["letter"]),Y=c(["murkphp_v1"]),L=(()=>{try{const t=localStorage.getItem("encryptConfig"),e=localStorage.getItem("restrictionConfig");return{encrypt:t?JSON.parse(t):{variableType:"letter",algorithm:"murkphp_v1"},restriction:e?JSON.parse(e):{domain:"",ip:"",expireDate:""}}}catch(t){return console.warn("Failed to load config from storage:",t),{encrypt:{variableType:"letter",algorithm:"murkphp_v1"},restriction:{domain:"",ip:"",expireDate:""}}}})(),w=D(L.encrypt),k=D(L.restriction),M=()=>{try{localStorage.setItem("encryptConfig",JSON.stringify(w)),localStorage.setItem("restrictionConfig",JSON.stringify(k))}catch(t){console.warn("Failed to save config to storage:",t)}},v=D({progress:0,message:"准备上传文件...",fileName:"",fileSize:""}),O=[{name:"字母",value:"letter"},{name:"数字",value:"number"},{name:"字母+数字",value:"mixed"}],A=[{name:"MurkPHP V1",value:"murkphp_v1"},{name:"MurkPHP V2",value:"murkphp_v2"},{name:"Advanced",value:"advanced"}],E=c([{id:1001,scriptName:"test.php",encryptStatus:"success",submitTime:"2024-01-15 10:30",completeTime:"2024-01-15 10:30",estimatedCost:.5,actualCost:.45,errorMessage:""},{id:1002,scriptName:"script.zip",encryptStatus:"processing",submitTime:"2024-01-15 10:25",completeTime:"",estimatedCost:1.2,actualCost:0,errorMessage:""},{id:1003,scriptName:"app.php",encryptStatus:"failed",submitTime:"2024-01-15 10:20",completeTime:"2024-01-15 10:20",estimatedCost:.4,actualCost:0,errorMessage:"文件格式不支持"}]),Z=()=>{var t;(t=C.value)==null||t.click()},ee=t=>{const e=t.target.files[0];if(!e)return;const u=50*1024*1024;if(e.size>u){z("文件大小不能超过50MB");return}const g=[".php",".zip"],B=e.name.toLowerCase().substring(e.name.lastIndexOf("."));if(!g.includes(B)){z("只支持 .php 和 .zip 文件");return}d.value=e,z("文件选择成功")},R=()=>{d.value=null,C.value&&(C.value.value="")},se=()=>{X.value=[w.variableType],_.value=!0},te=()=>{Y.value=[w.algorithm],y.value=!0},le=()=>{N.value=!0},oe=({selectedValue:t})=>{const e=new Date(t);k.expireDate=e.toISOString().split("T")[0],N.value=!1,M()},ae=t=>{const e=O.find(u=>u.value===t);return e?e.name:"字母"},ie=t=>{const e=A.find(u=>u.value===t);return e?e.name:"MurkPHP V1"},ne=t=>{w.variableType=t.value,_.value=!1,M()},re=t=>{w.algorithm=t.value,y.value=!1,M()},ce=async()=>{if(!d.value){z("请先选择要加密的文件");return}try{h.value=!0,v.progress=0,v.message="准备上传文件...",v.fileName=d.value.name,v.fileSize=J(d.value.size),x.value=!0;const t=[{progress:20,message:"正在上传文件...",delay:800},{progress:50,message:"文件上传完成，开始加密...",delay:1e3},{progress:80,message:"正在进行加密处理...",delay:1200},{progress:100,message:"加密完成，正在生成结果...",delay:600}];for(const e of t)v.progress=e.progress,v.message=e.message,await new Promise(u=>setTimeout(u,e.delay));x.value=!1,R(),z("文件已提交加密，请在加密记录中查看进度")}catch{x.value=!1,z("加密过程中发生错误，请重试")}finally{h.value=!1}},J=t=>{if(t===0)return"0 B";const e=1024,u=["B","KB","MB","GB"],g=Math.floor(Math.log(t)/Math.log(e));return parseFloat((t/Math.pow(e,g)).toFixed(2))+" "+u[g]},q=t=>{switch(t){case"success":return"成功";case"failed":return"失败";case"processing":return"处理中";case"queued":return"队列中";default:return"未知"}},G=t=>{switch(t){case"success":return"success";case"failed":return"danger";case"processing":return"warning";case"queued":return"info";default:return"default"}},de=t=>{i.value=t,S.value=!0},ue=()=>{z("开始下载加密文件"),S.value=!1};return(t,e)=>{const u=b("nut-input"),g=b("nut-button"),B=b("nut-tag"),K=b("nut-action-sheet"),pe=b("nut-date-picker"),ve=b("nut-popup"),me=b("nut-progress"),j=b("nut-dialog");return n(),r("div",Ie,[s("div",Fe,[s("div",Ue,[l(p(fe),{size:18}),e[12]||(e[12]=s("span",null,"文件上传",-1))]),s("div",{class:"upload-area",onClick:Z},[d.value?(n(),r("div",Oe,[s("div",Ae,[l(p(_e),{size:24,color:"#67c23a"})]),s("div",Ee,[s("div",Re,a(d.value.name),1),s("div",Je,a(J(d.value.size)),1)]),s("div",{class:"file-remove",onClick:ye(R,["stop"])},[l(p(be),{size:16,color:"#f56c6c"})])])):(n(),r("div",Le,[l(p(ge),{size:32,color:"#409eff"}),e[13]||(e[13]=s("div",{class:"upload-text"},"点击选择文件",-1)),e[14]||(e[14]=s("div",{class:"upload-hint"},"支持 .php, .zip 文件",-1))]))]),s("input",{ref_key:"fileInput",ref:C,type:"file",accept:Fs,onChange:ee,style:{display:"none"}},null,544)]),s("div",qe,[s("div",Ge,[l(p(W),{size:18}),e[15]||(e[15]=s("span",null,"加密配置",-1))]),s("div",{class:"config-item",onClick:se},[e[16]||(e[16]=s("div",{class:"config-label"},"变量类型",-1)),s("div",Ke,[s("span",null,a(ae(w.variableType)),1),l(p(P),{size:14,color:"#c8c9cc"})])]),s("div",{class:"config-item",onClick:te},[e[17]||(e[17]=s("div",{class:"config-label"},"加密算法",-1)),s("div",je,[s("span",null,a(ie(w.algorithm)),1),l(p(P),{size:14,color:"#c8c9cc"})])])]),s("div",Qe,[s("div",We,[l(p(W),{size:18}),e[18]||(e[18]=s("span",null,"运行限制",-1))]),s("div",Xe,[e[19]||(e[19]=s("div",{class:"restriction-label"},"域名限制",-1)),l(u,{modelValue:k.domain,"onUpdate:modelValue":e[0]||(e[0]=o=>k.domain=o),placeholder:"example.com",clearable:"",class:"restriction-input",onBlur:M},null,8,["modelValue"])]),s("div",Ye,[e[20]||(e[20]=s("div",{class:"restriction-label"},"IP限制",-1)),l(u,{modelValue:k.ip,"onUpdate:modelValue":e[1]||(e[1]=o=>k.ip=o),placeholder:"192.168.1.1",clearable:"",class:"restriction-input",onBlur:M},null,8,["modelValue"])]),s("div",{class:"restriction-item",onClick:le},[e[21]||(e[21]=s("div",{class:"restriction-label"},"时间限制",-1)),s("div",Ze,[s("span",null,a(k.expireDate||"永久有效"),1),l(p(P),{size:14,color:"#c8c9cc"})])])]),s("div",es,[l(g,{type:"primary",size:"large",block:"",loading:h.value,disabled:!d.value,onClick:ce},{default:m(()=>[V(a(h.value?"加密中...":"开始加密"),1)]),_:1},8,["loading","disabled"])]),s("div",ss,[s("div",ts,[l(p(Q),{size:18}),e[22]||(e[22]=s("span",null,"加密记录",-1))]),s("div",ls,[(n(!0),r(Ce,null,he(E.value,o=>(n(),r("div",{key:o.id,class:"record-item",onClick:Os=>de(o)},[s("div",as,[s("div",is,a(o.scriptName),1),s("div",ns,a(o.submitTime),1)]),s("div",rs,[l(B,{type:G(o.encryptStatus),size:"small"},{default:m(()=>[V(a(q(o.encryptStatus)),1)]),_:2},1032,["type"])])],8,os))),128)),E.value.length===0?(n(),r("div",cs,[l(p(Q),{size:48,color:"#ddd"}),e[23]||(e[23]=s("div",{class:"empty-text"},"暂无加密记录",-1))])):T("",!0)])]),l(K,{visible:_.value,"onUpdate:visible":e[2]||(e[2]=o=>_.value=o),"menu-items":O,title:"选择变量类型",onChoose:ne,onCancel:e[3]||(e[3]=o=>_.value=!1)},null,8,["visible"]),l(K,{visible:y.value,"onUpdate:visible":e[4]||(e[4]=o=>y.value=o),"menu-items":A,title:"选择加密算法",onChoose:re,onCancel:e[5]||(e[5]=o=>y.value=!1)},null,8,["visible"]),l(ve,{visible:N.value,"onUpdate:visible":e[7]||(e[7]=o=>N.value=o),position:"bottom"},{default:m(()=>[l(pe,{modelValue:U.value,"onUpdate:modelValue":e[6]||(e[6]=o=>U.value=o),"three-dimensional":!1,onConfirm:oe},null,8,["modelValue"])]),_:1},8,["visible"]),l(j,{visible:x.value,"onUpdate:visible":e[8]||(e[8]=o=>x.value=o),title:"文件加密中","close-on-click-overlay":!1,"show-cancel-button":!1,"show-ok-button":!1},{default:m(()=>[s("div",ds,[s("div",us,[l(p(we),{size:32,color:"#409eff",class:"rotating"})]),s("div",ps,a(v.message),1),s("div",vs,[l(me,{percentage:v.progress,"show-text":!1,"stroke-color":"#409eff"},null,8,["percentage"]),s("div",ms,a(v.progress)+"%",1)]),s("div",fs,[s("div",gs,a(v.fileName),1),s("div",_s,a(v.fileSize),1)])])]),_:1},8,["visible"]),l(j,{visible:S.value,"onUpdate:visible":e[11]||(e[11]=o=>S.value=o),title:"加密详情","close-on-click-overlay":!1},{footer:m(()=>[i.value?(n(),r("div",$s,[i.value.encryptStatus==="success"?(n(),r("div",Hs,[l(g,{type:"default",size:"normal",onClick:e[9]||(e[9]=o=>S.value=!1)},{default:m(()=>e[32]||(e[32]=[V(" 关闭 ",-1)])),_:1,__:[32]}),l(g,{type:"success",size:"normal",onClick:ue},{default:m(()=>e[33]||(e[33]=[V(" 下载 ",-1)])),_:1,__:[33]})])):(n(),r("div",Is,[l(g,{type:"primary",size:"normal",block:"",onClick:e[10]||(e[10]=o=>S.value=!1)},{default:m(()=>e[34]||(e[34]=[V(" 关闭 ",-1)])),_:1,__:[34]})]))])):T("",!0)]),default:m(()=>[i.value?(n(),r("div",ys,[s("div",bs,[e[24]||(e[24]=s("span",{class:"detail-label"},"加密ID",-1)),s("span",Cs,a(i.value.id),1)]),s("div",hs,[e[25]||(e[25]=s("span",{class:"detail-label"},"脚本名称",-1)),s("span",ws,a(i.value.scriptName),1)]),s("div",ks,[e[26]||(e[26]=s("span",{class:"detail-label"},"加密状态",-1)),l(B,{type:G(i.value.encryptStatus),size:"small"},{default:m(()=>[V(a(q(i.value.encryptStatus)),1)]),_:1},8,["type"])]),s("div",zs,[e[27]||(e[27]=s("span",{class:"detail-label"},"提交时间",-1)),s("span",Ss,a(i.value.submitTime),1)]),i.value.completeTime?(n(),r("div",Vs,[e[28]||(e[28]=s("span",{class:"detail-label"},"完成时间",-1)),s("span",Ts,a(i.value.completeTime),1)])):T("",!0),s("div",xs,[e[29]||(e[29]=s("span",{class:"detail-label"},"预计费用",-1)),s("span",Ms,"¥"+a(i.value.estimatedCost),1)]),i.value.actualCost>0?(n(),r("div",Ns,[e[30]||(e[30]=s("span",{class:"detail-label"},"实际费用",-1)),s("span",Bs,"¥"+a(i.value.actualCost),1)])):T("",!0),i.value.errorMessage?(n(),r("div",Ds,[e[31]||(e[31]=s("span",{class:"detail-label"},"错误信息",-1)),s("span",Ps,a(i.value.errorMessage),1)])):T("",!0)])):T("",!0)]),_:1},8,["visible"])])}}},Rs=ke(Us,[["__scopeId","data-v-6022c603"]]);export{Rs as default};
